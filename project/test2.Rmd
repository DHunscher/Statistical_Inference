
# Statistical Inference Course Project 

Author: Dale Hunscher

Creation Date: Friday, 27 April 2018

## Part 2: Tooth Growth Analysis

### Overview

The official description says:

> *The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).*

### Setup


Set working directory and load libraries:

```{r eval = TRUE, echo = TRUE }
setwd("/Users/dalehunscher/Dropbox/Coursera/Statistical_Inference/project")

library(knitr) 
library(ggplot2) 
library(graphics)
library(datasets)

```

Now intialize some variables we'll be using later on.

```{r eval = TRUE, echo = TRUE }
# load the data set into a transient variable

tooth <- ToothGrowth

oj.group <- tooth[tooth$supp == "OJ",c("len","dose")]
vc.group <- tooth[tooth$supp == "VC",c("len","dose")]

# determine range of tooth lengths

vcLengthRange <- range(vc.group$len)
ojLengthRange <- range(oj.group$len)
minmaxLengthRange <- c(min(ojLengthRange[1],vcLengthRange[1]),max(ojLengthRange[2],vcLengthRange[2]))

# determine range of doses

vcDoseRange <-  range(vc.group$dose)
ojDoseRange <-  range(oj.group$dose)
minmaxDoseRange <- c(min(ojDoseRange[1],vcDoseRange[1]),max(ojDoseRange[2],vcDoseRange[2]))

```

### Exploratory Analysis

Now we'll produce a summary of the data set and see what we can learn from it.

```{r eval = TRUE, echo = TRUE }

# summarize the data

summary(tooth)

```

We have 60 data points. 30 are associated with the supp (dietary supplement) factor "OJ" (referring to ascorbic acid in orange juice form), and the remaining 30 with the supp factor "VC" (referring to ascorbic acid - Vitamin C - in pure chemical form). Each row represents a tooth length measurement (len column), a dietary supplement (supp column), and a dosage (dose column). $$$$

Now let's do a simple plot of the data set and see what we can learn from that.

```{r eval = TRUE, echo = TRUE }
plot(minmaxDoseRange,minmaxLengthRange, type = "n", xlab = "Dose", ylab = "Tooth Length")
nTeeth <- length(vc.group)
colors <- rainbow(nTeeth)
linetype <- c(1:nTeeth)
plotchar <- seq(18,18+nTeeth,1)
lines(doses, vcMeans, type = "b", lwd = 1.5,lty=linetype[1],col=colors[1],pch=plotchar[1])
lines(doses, ojMeans, type = "b", lwd = 1.5,lty=linetype[2],col=colors[2],pch=plotchar[2])
title("Tooth Growth","of Ascorbic Acid as Chemical or in Orange Juice")
legend(minmaxLengthRange[1], minmaxDoseRange[2], 1:2, cex=0.8,col=colors,pch=plotchar,lty=linetype,title="Legend")
```


### Hypothesis Testing: Does Type of Supplement Matter?

We choose to use the Student's T-test statistic because the sample groups are small. We are making an assumption that the variances are approximately equal.

Our null hypothesis is that the two groups, OJ and VC, are the same at any given dosage level. Because the Tooth Growth chart above appears to show that OJ is more effective than VC, our alternative hypothesis is that the mean of the OJ group is significantly greater than the mean of the VC group with a confidence of 95%. 

We will do three separate analyses to test the significance of the difference between the two treatments at each dosage level.

#### Dosage = 0.5 mg/day

Difference beween the group means (positive value shows that OJ mean is greater than VC mean):

```{r eval = TRUE, echo = TRUE }

mean(oj.group$len[which(oj.group$dose == 0.5)])-mean(vc.group$len[which(vc.group$dose == 0.5)])

```

Orange juice appears to have a significant advantage over pure ascorbic acid, based both on the large difference in means and eyeballing the Tooth Growth chart.

T-Test of the alternative hypothesis that OJ mean significantly greater than VC mean:

```{r eval = TRUE, echo = TRUE }

result <- t.test(oj.group$len[which(oj.group$dose == 0.5)],vc.group$len[which(vc.group$dose == 0.5)],alternative="greater")

```

P-value is `r result$p.value`  
Upper limit of rejection region:  
`r result$conf.int[1] `

The mean of `r mean(oj.group$len[which(oj.group$dose == 0.5)])-mean(vc.group$len[which(vc.group$dose == 0.5)])` is greater than the upper limit of the rejection region at 95% confidence level, so we can reject the null hypothesis. At a dose of 0.5 mg/day, ascorbic acid via orange juice is significantly more effective than pure ascorbic acid alone.



#### Dosage = 1.0 mg/day

Difference beween the group means (positive value shows that OJ mean is greater than VC mean):

```{r eval = TRUE, echo = TRUE }

mean(oj.group$len[which(oj.group$dose == 1.0)])-mean(vc.group$len[which(vc.group$dose == 1.0)])

```


Orange juice still appears to have a significant advantage over pure ascorbic acid, based both on the large difference in means and eyeballing the Tooth Growth chart.

T-Test of the alternative hypothesis that OJ mean significantly greater than VC mean:

```{r eval = TRUE, echo = TRUE }

result <- t.test(oj.group$len[which(oj.group$dose == 1.0)],vc.group$len[which(vc.group$dose == 1.0)],alternative="greater")

```

P-value is `r result$p.value`  
Upper limit of rejection region:  
`r result$conf.int[1] `

The mean of `r mean(oj.group$len[which(oj.group$dose == 1.0)])-mean(vc.group$len[which(vc.group$dose == 1.0)])` is greater than the upper limit of the rejection region at 95% confidence level, so we can reject the null hypothesis. At a dose of 1.0 mg/day, ascorbic acid via orange juice is significantly more effective than pure ascorbic acid alone.



#### Dosage = 2.0 mg/day

Difference beween the group means (positive value shows that OJ mean is greater than VC mean):

```{r eval = TRUE, echo = TRUE }

mean(oj.group$len[which(oj.group$dose == 2.0)])-mean(vc.group$len[which(vc.group$dose == 2.0)])

```

The difference is now close to zero (and actually leans in favor of pure ascorbic acid, in constrast to the smaller dosages). We can reasonably assume we will fail to reject the null hypothesis in this case, but let's do the test to make sure.

This time we will use a two-tail test with the null hypothesis that the difference in means is insignificant. This will test the more general case of the two means being significantly different. If the difference turned out to be significant, we would need to investigate more deeply to determine which treatment was the greater.

T-Test of the alternative hypothesis that OJ mean significantly greater than VC mean:

```{r eval = TRUE, echo = TRUE }

result <- t.test(oj.group$len[which(oj.group$dose == 2.0)],vc.group$len[which(vc.group$dose == 2.0)])

```

P-value is `r result$p.value`  
Upper limit of rejection region:  
`r result$conf.int[1] ` : `r result$conf.int[2] `

The p-value is much greater than the 95% cutoff of 0.05, so we can accept the null hypothesis, that the difference in means is insignificant. The null hypothesis's posited mean of 0 and the actual mean of the differences, {r mean(oj.group$len[which(oj.group$dose == 2.0)])-mean(vc.group$len[which(vc.group$dose == 2.0)]) }, are both well within the rejection region. At a dose of 2.0 mg/day, ascorbic acid via orange juice is NOT significantly more effective than pure ascorbic acid alone.

### Hypothesis Testing: Does Dosage Matter?

Our analysis would be incomplete if we did not also look at the significance of the different dosage levels under each supplement. 

Why do we care? We have seen thus far that a dietary supplement of ascorbic acid in orange juice is superior to pure ascorbic acid for lower dosage levels (0.5 and 1.0 mg/day), but the effectiveness of the two supplements is not significantly different at the higher dosage of 2.0 mg/day.

Let's assume that pure ascorbic acid is less expensive per milligram than its equivalent in orange juice. The most cost-effective approach would then be pure ascorbic acid at 2.0 mg/day -- but only if the gain in growth rates between, for example, 1.0 and 2.0 mg/day were significant enough to justify the increased cost. 

A deeper analysis would compare the cost and benefit of the different combinations of supplement and dosage in terms of growth rate improvements. Perhaps guinea pig teeth are valuable in Chinese medicine, in which case benefit will trump cost in the decision-making process. This analysis is out of the scope of this project, since we have been given neither the cost of supplements nor the means to evaluate the potential sale price of guinea pig teeth. 

Staying within our scope, we will look at the significance of length gains length for each dosage level and the next higher increment in dosage. We will do this by supplement, treating it as a potentially confounding variable.

For each supplement, we will compare 0.5 versus 1.0 mg/day and 1.0 versus 2.0 mg/day.

Our null hypothesis throughout is that the difference between the two dosage levels under consideration is insignificant with 95% confidence.

#### Orange Juice (OJ)

##### 0.5 versus 1.0 mg/day

```{r eval = TRUE, echo = TRUE }

t.test(tooth$len[tooth$dose==0.5 & tooth$supp == "OJ"],tooth$len[tooth$dose==1.0 & tooth$supp == "OJ"])$p.value
```

The p-value is less than 0.05 and positive, hence the higher dosage is significantly more effective at stimulating tooth growth.

##### 1.0 versus 2.0 mg/day 

```{r eval = TRUE, echo = TRUE }

t.test(tooth$len[tooth$dose==1.0 & tooth$supp == "OJ"],tooth$len[tooth$dose==2.0 & tooth$supp == "OJ"])$p.value
```

Once again, the p-value is less than 0.05 and positive, hence the higher dosage is significantly more effective at stimulating tooth growth.

#### Pure Ascorbic Acid (VC)

##### 0.5 versus 1.0 mg/day 


```{r eval = TRUE, echo = TRUE }
t.test(tooth$len[tooth$dose==0.5 & tooth$supp == "VC"],tooth$len[tooth$dose==1.0 & tooth$supp == "VC"])$p.value
```

In this case as well, the p-value is less than 0.05 and positive, hence the higher dosage is significantly more effective at stimulating tooth growth.

##### 1.0 versus 2.0 mg/day 

```{r eval = TRUE, echo = TRUE }

t.test(tooth$len[tooth$dose==1.0 & tooth$supp == "VC"],tooth$len[tooth$dose==2.0 & tooth$supp == "VC"])$p.value
```

And also in our final test case, the p-value is less than 0.05 and positive, hence the higher dosage is significantly more effective at stimulating tooth growth.

### Conclusions Of Tooth Growth Analysis

* The higher the dosage the better, regardless of supplement.

* At lower dosages (0.5 and 1.0 mg/day), the performance of orange juice is significantly better than pure ascorbic acid.

* At the highest dosage level tested, 2.0 mg/day, the performance of orange juice and pure ascorbic acid are roughly equivalent.

